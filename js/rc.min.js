var rc={DARK:"#272b30",MID:"#2e3338",LIGHT:"#49515a",LINE:"#3366cc",TEXT:"#c8c8c8"};rc.BACKGROUND=rc.DARK;rc.GRID=rc.LIGHT;
rc.CHART_OPTIONS={pointSize:6,backgroundColor:rc.BACKGROUND,selectionMode:"multiple",animation:{duration:100},series:{color:rc.LINE},tooltip:{textStyle:{color:rc.TEXT}},hAxis:{titleTextStyle:{color:rc.TEXT},textStyle:{color:rc.TEXT},baselineColor:rc.GRID,gridlines:{color:"transparent"}},vAxis:{format:"$#,###",titleTextStyle:{color:rc.TEXT},textStyle:{color:rc.TEXT},baselineColor:rc.GRID,gridlines:{color:rc.GRID}},legend:{position:"none"}};rc.storage=void 0;rc.chart=void 0;
rc.completeLoadDate=function(){rc.drawChart();setTimeout(function(){rc.highlightPoints();rc.viewModel.updateChart=rc.drawChart},1E3)};rc.hoverPointHandler=function(a){rc.lastPoint=a;var c=rc.viewModel.rows.indexOf(rc.viewModel.todayRow);a.row===c?rc.setChartSelection([{row:c,column:1}],rc.colorPoints):(a=rc.viewModel.rows()[a.row],rc.viewModel.highlight(a,!0),rc.highlightPoints(a))};rc.unhoverPointHandler=function(){rc.viewModel.unHighlightAllRows();rc.setChartSelection();rc.highlightPoints()};
rc.selectPointHandler=function(){rc.hoverPointHandler(rc.lastPoint)};rc.highlightPoints=function(a){var c=rc.viewModel.todayRow,b=rc.viewModel.rows.indexOf(c);if("undefined"===typeof a||null===a)a=[{row:b,column:1}];else{var d=a.isStart?a:a.matchingRow,e=d.matchingRow,f=rc.viewModel.rows.indexOf(d),g=rc.viewModel.rows.indexOf(e);a=[{row:f,column:1},{row:g,column:1},{row:b,column:1}]}rc.setChartSelection(a,function(){rc.colorPoints(d,e,c,f,g,b)})};
rc.colorPoints=function(a,c,b,d,e,f){rc.TODAY_COLOR||(rc.TODAY_COLOR=rc.$table.find(".active").children("td").first().css("backgroundColor"));a=$("svg>g>g>g>circle");c=[];for(b=0;b<a.length;b++)c.push(a[b].outerHTML);var g=1,k=2,h=3;c=4;b=5;6>a.length?rc.setSelectedPointColor(a[0],a[a.length-1],rc.TODAY_COLOR):(6<a.length&&("none"==a[2].getAttribute("fill")?(g+=3,k+=3,h+=3,c+=3,b+=3):"none"==a[4].getAttribute("fill")?(h+=3,c+=3,b+=3):"none"==a[6].getAttribute("fill")&&(b+=3)),f<d?(e=0,d=k,f=h,k=c,
h=b):f<e?(d=0,f=g,e=k,g=h,k=c,h=b):(d=0,f=g,e=c,g=b),rc.START_COLOR||(rc.START_COLOR=rc.$table.find("tr.start.highlight").first().css("backgroundColor")),rc.STOP_COLOR||(rc.STOP_COLOR=rc.$table.find("tr.stop.highlight").first().css("backgroundColor")),rc.setSelectedPointColor(a[d],a[f],rc.START_COLOR),rc.setSelectedPointColor(a[k],a[h],rc.STOP_COLOR),rc.setSelectedPointColor(a[e],a[g],rc.TODAY_COLOR))};rc.SELECT_RETRY_LIMIT=10;rc.callbackHandles=[];
rc.setChartSelection=function(a,c,b){try{rc.chart.setSelection(a),rc.callbackHandles.forEach(function(a){clearTimeout(a)}),c&&(c(),rc.callbackHandles=[setTimeout(c,20),setTimeout(c,50),setTimeout(c,100),setTimeout(c,200)])}catch(d){"number"!==typeof b&&(b=1),console.warn("Oddity setting selection, attempt "+b+" of "+rc.SELECT_RETRY_LIMIT,d),b<rc.SELECT_RETRY_LIMIT&&setTimeout(function(){rc.setChartSelection(a,c,b+1)},100)}};
rc.setSelectedPointColor=function(a,c,b){$(a).attr("stroke",b);$(c).attr("fill",b)};
rc.drawChart=function(){if(chartIsReady){rc.chart||(rc.chart=new google.visualization.LineChart(document.getElementById("chart")),google.visualization.events.addListener(rc.chart,"select",rc.selectPointHandler),google.visualization.events.addListener(rc.chart,"onmouseover",rc.hoverPointHandler),google.visualization.events.addListener(rc.chart,"onmouseout",rc.unhoverPointHandler));var a=rc.viewModel.rows();1>=a.length?rc.$chart.css("visibility","hidden"):rc.$chart.css("visibility","visible");for(var c=
null,b=null,d=[["Date","Owed"]],e=0;e<a.length;e++)if(a[e].isToday)b=a[e];else{if(b){if(c)var f=a[e],g=c.date.getTime(),k=b.date.getTime(),h=f.date.getTime()-g,g=(k-g)/h,c=c.owed().toFloat(),f=f.owed().toFloat(),f=c+g*(f-c);else f=0;d.push(rc.buildDot(b,f));b=null}c=a[e];d.push(rc.buildDot(c))}b&&d.push(rc.buildDot(b));rc.chart.draw(google.visualization.arrayToDataTable(d),rc.CHART_OPTIONS)}else rc.$chart.css("visibility","hidden"),console.error("Chart not ready")};
rc.buildDot=function(a,c){var b=a.date,d=b.toString().split(" ")[1]+" "+b.getDate()+", "+b.getFullYear();c=c||a.owed().toFloat();var e=a.owed().toString();return[{v:b,f:d},{v:c,f:e}]};rc.checkOverflow=function(){var a=rc.$column.width();rc.lastColWidth!==a&&(rc.lastColWidth=a,rc.$chart.css({width:a+"px",height:a+"px"}),rc.drawChart(),rc.largeTableWidth||(rc.largeTableWidth=rc.$table.width()),rc.viewModel.isSmall(rc.largeTableWidth>a))};
window.onload=function(){rc.$table=$("#dateTable");rc.$column=rc.$table.parent();rc.$chart=$("#chart");rc.storage=new StorageManager;rc.viewModel=new PageViewModel(rc.storage,rc.highlightPoints);ko.applyBindings(rc.viewModel);rc.viewModel.loadSavedData();rc.checkOverflow();$(window).resize(rc.checkOverflow);rc.completeLoadDate()};
